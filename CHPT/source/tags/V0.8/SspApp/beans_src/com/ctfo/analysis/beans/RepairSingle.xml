<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="RepairSingle">
  <typeAlias alias="dynamicSqlParameter" type="com.ctfo.local.obj.DynamicSqlParameter" />
  <resultMap class="com.ctfo.analysis.beans.RepairSingle" id="RepairSingle">
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Mar 24 16:46:46 CST 2014.
    -->
    <result column="settlement_id" property="settlementId" jdbcType="VARCHAR" />
    <result column="org_id" property="orgId" jdbcType="VARCHAR" />
    <result column="man_hour_sum_money" property="manHourSumMoney" jdbcType="DECIMAL" />
    <result column="man_hour_tax_rate" property="manHourTaxRate" jdbcType="DECIMAL" />
    <result column="man_hour_tax_cost" property="manHourTaxCost" jdbcType="DECIMAL" />
    <result column="man_hour_sum" property="manHourSum" jdbcType="DECIMAL" />
    <result column="fitting_sum_money" property="fittingSumMoney" jdbcType="DECIMAL" />
    <result column="fitting_tax_rate" property="fittingTaxRate" jdbcType="DECIMAL" />
    <result column="fitting_tax_cost" property="fittingTaxCost" jdbcType="DECIMAL" />
    <result column="fitting_sum" property="fittingSum" jdbcType="DECIMAL" />
    <result column="other_item_sum_money" property="otherItemSumMoney" jdbcType="DECIMAL" />
    <result column="other_item_tax_rate" property="otherItemTaxRate" jdbcType="DECIMAL" />
    <result column="other_item_tax_cost" property="otherItemTaxCost" jdbcType="DECIMAL" />
    <result column="other_item_sum" property="otherItemSum" jdbcType="DECIMAL" />
    <result column="should_sum" property="shouldSum" jdbcType="DECIMAL" />
    <result column="received_sum" property="receivedSum" jdbcType="DECIMAL" />
    <result column="privilege_cost" property="privilegeCost" jdbcType="DECIMAL" />
    <result column="debt_cost" property="debtCost" jdbcType="DECIMAL" />
    <result column="make_invoice_type" property="makeInvoiceType" jdbcType="VARCHAR" />
    <result column="payment_terms" property="paymentTerms" jdbcType="VARCHAR" />
    <result column="settlement_account" property="settlementAccount" jdbcType="VARCHAR" />
    <result column="settle_company" property="settleCompany" jdbcType="VARCHAR" />
    <result column="enable_flag" property="enableFlag" jdbcType="VARCHAR" />
    <result column="document_status" property="documentStatus" jdbcType="VARCHAR" />
    <result column="is_occupy" property="isOccupy" jdbcType="VARCHAR" />
    <result column="create_by" property="createBy" jdbcType="VARCHAR" />
    <result column="responsible_opid" property="responsibleOpid" jdbcType="VARCHAR" />
    <result column="responsible_name" property="responsibleName" jdbcType="VARCHAR" />
    <result column="org_name" property="orgName" jdbcType="VARCHAR" />
    <result column="update_by" property="updateBy" jdbcType="VARCHAR" />
    <result column="create_name" property="createName" jdbcType="VARCHAR" />
    <result column="update_name" property="updateName" jdbcType="VARCHAR" />
    <result column="update_time" property="updateTime" jdbcType="BIGINT" />
    <result column="create_time" property="createTime" jdbcType="BIGINT" />
    <result column="maintain_id" property="maintainId" jdbcType="VARCHAR" />
    <result column="ser_station_id" property="serStationId" jdbcType="VARCHAR" />
    <result column="set_book_id" property="setBookId" jdbcType="VARCHAR" />

    <result column="before_orderId" property="beforeOrderid" jdbcType="VARCHAR" />
    <result column="dispatch_status" property="dispatchStatus" jdbcType="CHAR" />
    <result column="orders_source" property="ordersSource" jdbcType="CHAR" />
    <result column="reception_time" property="receptionTime" jdbcType="BIGINT" />
    <result column="vehicle_no" property="vehicleNo" jdbcType="VARCHAR" />
    <result column="vehicle_vin" property="vehicleVin" jdbcType="VARCHAR" />
    <result column="vehicle_brand" property="vehicleBrand" jdbcType="VARCHAR" />
    <result column="vehicle_model" property="vehicleModel" jdbcType="VARCHAR" />
    <result column="engine_no" property="engineNo" jdbcType="VARCHAR" />
    <result column="driver_name" property="driverName" jdbcType="VARCHAR" />
    <result column="driver_mobile" property="driverMobile" jdbcType="VARCHAR" />
    <result column="vehicle_color" property="vehicleColor" jdbcType="VARCHAR" />
    <result column="maintain_no" property="maintainNo" jdbcType="VARCHAR" />
    <result column="customer_id" property="customerId" jdbcType="VARCHAR" />
    <result column="customer_name" property="customerName" jdbcType="VARCHAR" />
    <result column="customer_code" property="customerCode" jdbcType="VARCHAR" />
    <result column="member_id" property="memberId" jdbcType="VARCHAR" />
    <result column="linkman" property="linkman" jdbcType="VARCHAR" />
    <result column="link_man_mobile" property="linkManMobile" jdbcType="VARCHAR" />
    <result column="import_status" property="importStatus" jdbcType="CHAR" />
    <result column="maintain_type" property="maintainType" jdbcType="VARCHAR" />
    <result column="maintain_payment" property="maintainPayment" jdbcType="VARCHAR" />
    <result column="maintain_man" property="maintainMan" jdbcType="VARCHAR" />
    <result column="oil_into_factory" property="oilIntoFactory" jdbcType="DECIMAL" />
    <result column="travel_mileage" property="travelMileage" jdbcType="DECIMAL" />
    <result column="completion_time" property="completionTime" jdbcType="BIGINT" />
    <result column="set_meal" property="setMeal" jdbcType="VARCHAR" />
    <result column="info_status" property="infoStatus" jdbcType="VARCHAR" />
    <result column="fault_describe" property="faultDescribe" jdbcType="VARCHAR" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />
    <result column="complete_work_time" property="completeWorkTime" jdbcType="BIGINT" />
    <result column="maintain_time" property="maintainTime" jdbcType="BIGINT" />
    <result column="maintain_mileage" property="maintainMileage" jdbcType="DECIMAL" />
    <result column="favorable_reason" property="favorableReason" jdbcType="VARCHAR" />

    <result column="member_number" property="memberNumber" jdbcType="VARCHAR" />
    <result column="workhours_discount" property="workhoursDiscount" jdbcType="VARCHAR" />
    <result column="accessories_discount" property="accessoriesDiscount" jdbcType="VARCHAR" />
    <result column="member_class" property="memberClass" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="table">
    tb_maintain_settlement_info
  </sql>
    <sql id="where">
    WHERE 1=1
  </sql> 
  <sql id="where_param">
    <include refid="where" />
    <include refid="equal_WHERE" />
  </sql>
  <sql id="equal_WHERE">
    <isNotNull prepend="AND" property="equal.maintainStatisId">
      jie.maintain_id =  #equal.maintainStatisId:VARCHAR#
    </isNotNull>
  </sql>
  <select id="countParam" parameterClass="dynamicSqlParameter" resultClass="int">
    SELECT COUNT(1) FROM 
			(SELECT 
			  jie.settlement_id,
			  jie.org_id,
			  jie.man_hour_sum_money,
			  jie.man_hour_tax_rate,
			  jie.man_hour_tax_cost,
			  jie.man_hour_sum,
			  jie.fitting_sum_money,
			  jie.fitting_tax_rate,
			  jie.fitting_tax_cost,
			  jie.fitting_sum,
			  jie.other_item_sum_money,
			  jie.other_item_tax_rate,
			  jie.other_item_tax_cost,
			  jie.other_item_sum,
			  jie.should_sum,
			  jie.received_sum,
			  jie.privilege_cost,
			  jie.debt_cost,
			  jie.make_invoice_type,
			  jie.payment_terms,
			  jie.settlement_account,
			  jie.settle_company,
			  jie.enable_flag,
			  jie.document_status,
			  jie.is_occupy,
			  IFNULL(jie.create_by,'') AS create_by,
			  IFNULL(jie.responsible_opid,'') AS responsible_opid,
			  IFNULL(jie.responsible_name,'') AS responsible_name,
			  IFNULL(jie.org_name,'') AS org_name,
			  jie.update_by,
			  IFNULL(jie.create_name,'') AS create_name,
			  IFNULL(jie.update_name,'') AS update_name,
			  jie.update_time,
			  jie.create_time,
			  jie.maintain_id,
			  jie.ser_station_id,
			  jie.set_book_id,
			  dan.before_orderId,
			  dan.dispatch_status,
			  dan.orders_source,
			  dan.reception_time,
			  dan.vehicle_no,
			  dan.vehicle_vin,
			  dan.vehicle_brand,
			  dan.vehicle_model,
			  dan.engine_no,
			  dan.driver_name,
			  dan.driver_mobile,
			  dan.vehicle_color,
			  dan.maintain_no,
			  dan.customer_id,
			  dan.customer_name,
			  dan.customer_code,
			  dan.member_id,
			  dan.linkman,
			  dan.link_man_mobile,
			  dan.import_status,
			  dan.maintain_type,
			  dan.maintain_payment,
			  dan.maintain_man,
			  dan.oil_into_factory,
			  dan.travel_mileage,
			  dan.completion_time,
			  dan.set_meal,
			  dan.info_status,
			  dan.fault_describe,
			  dan.remark,
			  dan.complete_work_time,
			  dan.maintain_time,
			  dan.maintain_mileage,
			  dan.favorable_reason,
			  cu.member_number,
			  cu.workhours_discount,
			  cu.accessories_discount,
			  cu.member_class 
			FROM
			  tb_maintain_info dan 
			  LEFT JOIN tb_maintain_settlement_info jie 
			    ON dan.maintain_id = jie.maintain_id 
			  LEFT JOIN tb_customer cu 
			    ON dan.customer_code = cu.cust_code 
			  <include refid="where_param" /> ) BB
  </select> 
  <select id="selectPageForParam" parameterClass="dynamicSqlParameter" resultMap="RepairSingle">
		SELECT BB.* FROM 
	    (
			SELECT 
			  jie.settlement_id,
			  jie.org_id,
			  jie.man_hour_sum_money,
			  jie.man_hour_tax_rate,
			  jie.man_hour_tax_cost,
			  jie.man_hour_sum,
			  jie.fitting_sum_money,
			  jie.fitting_tax_rate,
			  jie.fitting_tax_cost,
			  jie.fitting_sum,
			  jie.other_item_sum_money,
			  jie.other_item_tax_rate,
			  jie.other_item_tax_cost,
			  jie.other_item_sum,
			  jie.should_sum,
			  jie.received_sum,
			  jie.privilege_cost,
			  jie.debt_cost,
			  jie.make_invoice_type,
			  jie.payment_terms,
			  jie.settlement_account,
			  jie.settle_company,
			  jie.enable_flag,
			  jie.document_status,
			  jie.is_occupy,
			  IFNULL(jie.create_by,'') AS create_by,
			  IFNULL(jie.responsible_opid,'') AS responsible_opid,
			  IFNULL(jie.responsible_name,'') AS responsible_name,
			  IFNULL(jie.org_name,'') AS org_name,
			  jie.update_by,
			  IFNULL(jie.create_name,'') AS create_name,
			  IFNULL(jie.update_name,'') AS update_name,
			  jie.update_time,
			  jie.create_time,
			  jie.maintain_id,
			  jie.ser_station_id,
			  jie.set_book_id,
			  dan.before_orderId,
			  dan.dispatch_status,
			  dan.orders_source,
			  dan.reception_time,
			  dan.vehicle_no,
			  dan.vehicle_vin,
			  dan.vehicle_brand,
			  dan.vehicle_model,
			  dan.engine_no,
			  dan.driver_name,
			  dan.driver_mobile,
			  dan.vehicle_color,
			  dan.maintain_no,
			  dan.customer_id,
			  dan.customer_name,
			  dan.customer_code,
			  dan.member_id,
			  dan.linkman,
			  dan.link_man_mobile,
			  dan.import_status,
			  dan.maintain_type,
			  dan.maintain_payment,
			  dan.maintain_man,
			  dan.oil_into_factory,
			  dan.travel_mileage,
			  dan.completion_time,
			  dan.set_meal,
			  dan.info_status,
			  dan.fault_describe,
			  dan.remark,
			  dan.complete_work_time,
			  dan.maintain_time,
			  dan.maintain_mileage,
			  dan.favorable_reason,
			  cu.member_number,
			  cu.workhours_discount,
			  cu.accessories_discount,
			  cu.member_class 
			FROM
			  tb_maintain_info dan 
			  LEFT JOIN tb_maintain_settlement_info jie 
			    ON dan.maintain_id = jie.maintain_id 
			  LEFT JOIN tb_customer cu 
			    ON dan.customer_code = cu.cust_code 
			  <include refid="where_param" />
			  GROUP BY jie.settlement_id
	    ) BB
	    LIMIT #startNum#,#pagesize#
  </select> 
  <select id="selectPk" parameterClass="string" resultMap="RepairSingle">
		SELECT 
		  jie.settlement_id,
		  jie.org_id,
		  jie.man_hour_sum_money,
		  jie.man_hour_tax_rate,
		  jie.man_hour_tax_cost,
		  jie.man_hour_sum,
		  jie.fitting_sum_money,
		  jie.fitting_tax_rate,
		  jie.fitting_tax_cost,
		  jie.fitting_sum,
		  jie.other_item_sum_money,
		  jie.other_item_tax_rate,
		  jie.other_item_tax_cost,
		  jie.other_item_sum,
		  jie.should_sum,
		  jie.received_sum,
		  jie.privilege_cost,
		  jie.debt_cost,
		  jie.make_invoice_type,
		  jie.payment_terms,
		  jie.settlement_account,
		  jie.settle_company,
		  jie.enable_flag,
		  jie.document_status,
		  jie.is_occupy,
		  IFNULL(jie.create_by,'') AS create_by,
		  IFNULL(jie.responsible_opid,'') AS responsible_opid,
		  IFNULL(jie.responsible_name,'') AS responsible_name,
		  IFNULL(jie.org_name,'') AS org_name,
		  jie.update_by,
		  IFNULL(jie.create_name,'') AS create_name,
		  IFNULL(jie.update_name,'') AS update_name,
		  jie.update_time,
		  jie.create_time,
		  jie.maintain_id,
		  jie.ser_station_id,
		  jie.set_book_id,
		  dan.before_orderId,
		  dan.dispatch_status,
		  dan.orders_source,
		  dan.reception_time,
		  dan.vehicle_no,
		  dan.vehicle_vin,
		  dan.vehicle_brand,
		  dan.vehicle_model,
		  dan.engine_no,
		  dan.driver_name,
		  dan.driver_mobile,
		  dan.vehicle_color,
		  dan.maintain_no,
		  dan.customer_id,
		  dan.customer_name,
		  dan.customer_code,
		  dan.member_id,
		  dan.linkman,
		  dan.link_man_mobile,
		  dan.import_status,
		  dan.maintain_type,
		  dan.maintain_payment,
		  dan.maintain_man,
		  dan.oil_into_factory,
		  dan.travel_mileage,
		  dan.completion_time,
		  dan.set_meal,
		  dan.info_status,
		  dan.fault_describe,
		  dan.remark,
		  dan.complete_work_time,
		  dan.maintain_time,
		  dan.maintain_mileage,
		  dan.favorable_reason,
		  cu.member_number,
		  cu.workhours_discount,
		  cu.accessories_discount,
		  cu.member_class 
		FROM
		  tb_maintain_info dan 
		  LEFT JOIN tb_maintain_settlement_info jie 
		    ON dan.maintain_id = jie.maintain_id 
		  LEFT JOIN tb_customer cu 
		    ON dan.customer_code = cu.cust_code 
   		 where dan.maintain_id = #maintain_id:VARCHAR#
  </select>
</sqlMap>