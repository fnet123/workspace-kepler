<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="CompanyInfo">
  <typeAlias alias="dynamicSqlParameter" type="com.ctfo.local.obj.DynamicSqlParameter" />
  <resultMap class="com.ctfo.operation.beans.CompanyInfo" id="CompanyInfo">
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Mon Mar 24 16:46:46 CST 2014.
    -->
    <result column="COM_ID" jdbcType="VARCHAR" property="comId" />
    <result column="CS_COM_ID" jdbcType="VARCHAR" property="csComId" />
    <result column="COM_NAME" jdbcType="VARCHAR" property="comName" />
    <result column="COM_SHORT_NAME" jdbcType="VARCHAR" property="comShortName" />
    <result column="COM_ADDRESS" jdbcType="VARCHAR" property="comAddress" />
    <result column="PROVINCE" jdbcType="VARCHAR" property="province" />
    <result column="CITY" jdbcType="VARCHAR" property="city" />
    <result column="COUNTY" jdbcType="VARCHAR" property="county" />
    <result column="ZIP_CODE" jdbcType="VARCHAR" property="zipCode" />
    <result column="COM_CONTACT" jdbcType="VARCHAR" property="comContact" />
    <result column="COM_EMAIL" jdbcType="VARCHAR" property="comEmail" />
    <result column="COM_TEL" jdbcType="VARCHAR" property="comTel" />
    <result column="HOT_LTEL" jdbcType="VARCHAR" property="hotLtel" />
    <result column="COM_FAX" jdbcType="VARCHAR" property="comFax" />
    <result column="REPAIR_QUALIFICATION" jdbcType="VARCHAR" property="repairQualification" />
    <result column="UNIT_PROPERTIES" jdbcType="VARCHAR" property="unitProperties" />
    <result column="LEGAL_PERSON" jdbcType="VARCHAR" property="legalPerson" />
    <result column="CERTIFICATE_CODE" jdbcType="VARCHAR" property="certificateCode" />
    <result column="REGISTER_AUTHENTICATION" jdbcType="VARCHAR" property="registerAuthentication" />
    <result column="REGISTER_METHOD" jdbcType="VARCHAR" property="registerMethod" />
    <result column="COM_TYPE" jdbcType="VARCHAR" property="comType" />
    <result column="MACHINE_SERIAL" jdbcType="VARCHAR" property="machineSerial" />
    <result column="MAC_ADDRESS" jdbcType="VARCHAR" property="macAddress" />
    <result column="SERVICE_VERSION" jdbcType="VARCHAR" property="serviceVersion" />
    <result column="SERVICE_STATUS" jdbcType="VARCHAR" property="serviceStatus" />
    <result column="REGIST_TIME" jdbcType="BIGINT" property="registTime" nullValue="0"/>
    <result column="REGIST_IP" jdbcType="VARCHAR" property="registIp" />
    <result column="CLIENT_NUMS" jdbcType="VARCHAR" property="clientNums" />
    <result column="YT_CRM_LINKED_STATUS" jdbcType="VARCHAR" property="ytCrmLinkedStatus" />
    <result column="SETBOOK_ID" jdbcType="VARCHAR" property="setbookId" />
    <result column="STATUS" jdbcType="VARCHAR" property="status" />
    <result column="AUTHORIZATION_CODE" jdbcType="VARCHAR" property="authorizationCode" />
    <result column="VALID_DATE" jdbcType="BIGINT" property="validDate" nullValue="0"/>
    <result column="APPROVER" jdbcType="VARCHAR" property="approver" />
    <result column="APPROVAL_TIME" jdbcType="BIGINT" property="approvalTime" nullValue="0"/>
    <result column="APPROVAL_ADVICE" jdbcType="VARCHAR" property="approvalAdvice" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="ENABLE_FLAG" jdbcType="VARCHAR" property="enableFlag" />
    <result column="OPEN_BANK" jdbcType="VARCHAR" property="openBank" />
    <result column="BANK_ACCOUNT" jdbcType="VARCHAR" property="bankAccount" />
    <result column="VALUEADD_APP_ID" jdbcType="VARCHAR" property="valueaddAppId" />
    <result column="CREATE_BY" jdbcType="VARCHAR" property="createBy" />
    <result column="CREATE_TIME" jdbcType="BIGINT" property="createTime" nullValue="0"/>
    <result column="UPDATE_BY" jdbcType="VARCHAR" property="updateBy" />
    <result column="UPDATE_TIME" jdbcType="BIGINT" property="updateTime" nullValue="0"/>
    <result column="COM_ACCOUNT" jdbcType="VARCHAR" property="comAccount" />
    <result column="COM_PASS_WORD" jdbcType="VARCHAR" property="comPassWord" />
    <result column="AUTH_CODE" jdbcType="VARCHAR" property="authCode" />
    <result column="access_code" jdbcType="VARCHAR" property="accessCode" />
    <result column="service_station_sap" jdbcType="VARCHAR" property="serviceStationSap" />
  </resultMap>
   <resultMap class="com.ctfo.operation.beans.CompanyInfo" id="CompanyInfoByUser">
    
    <result column="COM_NAME" jdbcType="VARCHAR" property="comName" />
    <result column="COM_ADDRESS" jdbcType="VARCHAR" property="comAddress" />
    <result column="PROVINCE" jdbcType="VARCHAR" property="province" />
    <result column="CITY" jdbcType="VARCHAR" property="city" />
    <result column="COUNTY" jdbcType="VARCHAR" property="county" />
    <result column="ZIP_CODE" jdbcType="VARCHAR" property="zipCode" />
    <result column="COM_CONTACT" jdbcType="VARCHAR" property="comContact" />
    <result column="COM_EMAIL" jdbcType="VARCHAR" property="comEmail" />
    <result column="COM_TEL" jdbcType="VARCHAR" property="comTel" />
    <result column="HOT_LTEL" jdbcType="VARCHAR" property="hotLtel" />
    <result column="UNIT_PROPERTIES" jdbcType="VARCHAR" property="unitProperties" />
    <result column="COM_FAX" jdbcType="VARCHAR" property="comFax" />
    <result column="LEGAL_PERSON" jdbcType="VARCHAR" property="legalPerson" />
    <result column="REPAIR_QUALIFICATION" jdbcType="VARCHAR" property="repairQualification" />
    <result column="MACHINE_SERIAL" jdbcType="VARCHAR" property="machineSerial" />
    <result column="REGIST_TIME" jdbcType="BIGINT" property="registTime" nullValue="0"/>
    <result column="REGIST_IP" jdbcType="VARCHAR" property="registIp" />
    <result column="STATUS" jdbcType="VARCHAR" property="status" />
    <result column="VALID_DATE" jdbcType="BIGINT" property="validDate" nullValue="0"/>
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="REGISTER_AUTHENTICATION" jdbcType="VARCHAR" property="registerAuthentication" />
    <result column="COM_ACCOUNT" jdbcType="VARCHAR" property="comAccount" />
    <result column="AUTH_CODE" jdbcType="VARCHAR" property="authCode" />
    <result column="AUTHORIZATION_CODE" jdbcType="VARCHAR" property="authorizationCode" />
  </resultMap>
  <sql id="columns">
    COM_ID,CS_COM_ID,COM_NAME,COM_SHORT_NAME,COM_ADDRESS,
    PROVINCE,CITY,COUNTY,ZIP_CODE,COM_CONTACT,
    COM_EMAIL,COM_TEL,HOT_LTEL,COM_FAX,REPAIR_QUALIFICATION,
    UNIT_PROPERTIES,LEGAL_PERSON,CERTIFICATE_CODE,IF(valid_date &lt; #equal.nowDate:VARCHAR#,"0",REGISTER_AUTHENTICATION) AS REGISTER_AUTHENTICATION ,
    REGISTER_METHOD,COM_TYPE,MACHINE_SERIAL,MAC_ADDRESS,
    SERVICE_VERSION,SERVICE_STATUS,REGIST_TIME,REGIST_IP,CLIENT_NUMS,
    YT_CRM_LINKED_STATUS,SETBOOK_ID,STATUS,AUTHORIZATION_CODE,VALID_DATE,
    APPROVER,APPROVAL_TIME,APPROVAL_ADVICE,REMARK,ENABLE_FLAG,
    OPEN_BANK,BANK_ACCOUNT,VALUEADD_APP_ID,CREATE_BY,CREATE_TIME,
    UPDATE_BY,UPDATE_TIME,COM_ACCOUNT,COM_PASS_WORD,AUTH_CODE,AUTH_CODE as TOTAL ,access_code,service_station_sap
  </sql>
  <sql id="table">
    tb_ssp_com_info
  </sql>
  <sql id="ff">
  	valid_date &lt; #equal.nowDate:VARCHAR# 
  </sql>
  
  <sql id="gg">
  	valid_date &gt; #equal.nowDate:VARCHAR# 
  </sql>
  
  <sql id="where">
    WHERE 1=1
  </sql> 
    <sql id="where_param">
    
    <include refid="where" />
    <include refid="equal_WHERE" />
    <include refid="like_WHERE" />
  </sql>
  <sql id="equal_WHERE">
    <isNotNull prepend="AND" property="equal.machineSerial">
      MACHINE_SERIAL =  #equal.machineSerial:VARCHAR#
    </isNotNull>  
    <isNotNull prepend="AND" property="equal.province">
      PROVINCE =  #equal.province:VARCHAR#
    </isNotNull>
    <isNotNull prepend="AND" property="equal.city">
      CITY =  #equal.city:VARCHAR#
    </isNotNull>
    <isNotNull prepend="AND" property="equal.county">
      COUNTY =  #equal.county:VARCHAR#
    </isNotNull>
    <isNotNull prepend="AND" property="equal.serviceStatus">
      SERVICE_STATUS =  #equal.serviceStatus:VARCHAR#
    </isNotNull>    
    <isNotNull prepend="AND" open="(" property="equal.registerAuthentication">
      REGISTER_AUTHENTICATION =  #equal.registerAuthentication:VARCHAR#
      	<isEqual prepend="OR" property="registerAuthentication" close=")" compareValue="0">
      		<include refid="ff"/>
      	</isEqual>
      	<isEqual prepend="AND" property="registerAuthentication" close=")" compareValue="1">
      		<include refid="gg"/>
      	</isEqual>
      	<isEqual prepend="AND" property="registerAuthentication" close=")" compareValue="2">
      		<include refid="gg"/>
      	</isEqual> 
      	<isEqual prepend="AND" property="registerAuthentication" close=")" compareValue="3">
      		<include refid="gg"/>
      	</isEqual>        	     	
    </isNotNull>
    <isNotNull prepend="AND" property="equal.status">
      STATUS = #equal.status:VARCHAR#
    </isNotNull>    
    <isNotNull prepend="AND" property="equal.registTimeStart">
        <![CDATA[(#equal.registTimeStart:VARCHAR# <= REGIST_TIME )]]>
    </isNotNull>
    <isNotNull prepend="AND" property="equal.registEndTimeEnd">
        <![CDATA[(#equal.registEndTimeEnd:VARCHAR# >= REGIST_TIME )]]>
    </isNotNull>   
    <isNotNull prepend="AND" property="equal.validTimeStart">
        <![CDATA[(#equal.validTimeStart:VARCHAR# <= VALID_DATE )]]>
    </isNotNull>
    <isNotNull prepend="AND" property="equal.validEndTimeEnd">
        <![CDATA[(#equal.validEndTimeEnd:VARCHAR# >= VALID_DATE )]]>
    </isNotNull>
    AND ENABLE_FLAG = '1'
  </sql> 
  <sql id="like_WHERE">
  <isNotNull prepend="AND" property="like.comName">
      COM_NAME like CONCAT('%',#like.comName:VARCHAR#,'%')
  </isNotNull>
  <isNotNull prepend="AND" property="like.comContact">
      COM_CONTACT like CONCAT('%',#like.comContact:VARCHAR#,'%')
    </isNotNull>    
  </sql> 
  <select id="countParam" parameterClass="dynamicSqlParameter" resultClass="int">
    SELECT COUNT(1) FROM 
    <include refid="table" />
    <include refid="where_param" />
  </select>
  <select id="selectPKById" parameterClass="map" resultMap="CompanyInfo">
  	SELECT 
    COM_ID,CS_COM_ID,COM_NAME,COM_SHORT_NAME,COM_ADDRESS,
    PROVINCE,CITY,COUNTY,ZIP_CODE,COM_CONTACT,
    COM_EMAIL,COM_TEL,HOT_LTEL,COM_FAX,REPAIR_QUALIFICATION,
    UNIT_PROPERTIES,LEGAL_PERSON,CERTIFICATE_CODE,IF(valid_date &lt; #nowDate#,"0",REGISTER_AUTHENTICATION) AS REGISTER_AUTHENTICATION ,
    REGISTER_METHOD,COM_TYPE,MACHINE_SERIAL,MAC_ADDRESS,
    SERVICE_VERSION,SERVICE_STATUS,REGIST_TIME,REGIST_IP,CLIENT_NUMS,
    YT_CRM_LINKED_STATUS,SETBOOK_ID,STATUS,AUTHORIZATION_CODE,VALID_DATE,
    APPROVER,APPROVAL_TIME,APPROVAL_ADVICE,REMARK,ENABLE_FLAG,
    OPEN_BANK,BANK_ACCOUNT,VALUEADD_APP_ID,CREATE_BY,CREATE_TIME,
    UPDATE_BY,UPDATE_TIME,COM_ACCOUNT,COM_PASS_WORD,AUTH_CODE,AUTH_CODE as TOTAL ,access_code,service_station_sap
	FROM 
	<include refid="table" />
    where COM_ID = #comId#
  </select>
  <select id="selectPageForParam" parameterClass="dynamicSqlParameter" resultMap="CompanyInfo">
		SELECT BB.* FROM 
	    (SELECT 
		    <include refid="columns" /> 
		     FROM 
		    <include refid="table" />
		    <include refid="where_param" />
	    ) BB  ORDER BY create_time DESC 
	    LIMIT #startNum#,#pagesize#
  </select>
  
    <!-- 吊销与启用 -->
  <update id="updateRevokeOpen" parameterClass="map">
	  UPDATE <include refid="table" />
	   SET STATUS = #status#
	  WHERE 1=1
	  <isNotNull property="comId" >
      <![CDATA[ AND COM_ID in ]]>
      <iterate property="comId" conjunction="," open="(" close=")">
          #comId[]#
      </iterate>
      </isNotNull>
  </update>
 <insert id="insert" parameterClass="com.ctfo.operation.beans.CompanyInfo">
	  INSERT INTO 
	  <include refid="table" />
	  (
  	   COM_ID,
	   COM_NAME,
	   PROVINCE,
	   CITY,
	   COUNTY,
	   COM_ADDRESS,
	   COM_TEL,
	   UNIT_PROPERTIES,
	   ZIP_CODE,
	   COM_EMAIL,
	   REPAIR_QUALIFICATION,
	   HOT_LTEL,
	   LEGAL_PERSON,
	   COM_FAX,
	   MACHINE_SERIAL,
	   REGIST_TIME,
	   REGIST_IP,
	   COM_ACCOUNT,
	   AUTH_CODE,
	   AUTHORIZATION_CODE,
	   VALID_DATE,
	   APPROVER,
	   APPROVAL_ADVICE,
	   REMARK,
	   CREATE_BY,
	   CREATE_TIME,
	   COM_CONTACT,
	   REGISTER_AUTHENTICATION,
	   STATUS,
	   COM_PASS_WORD,
	   access_code,
	   service_station_sap,
	   APPROVAL_TIME,
	   MAC_ADDRESS,
	   SERVICE_VERSION
	  )
	VALUES
	  (#comId#,
	   #comName#,
	   #province#,
	   #city#,
	   #county#,	   
	   #comAddress#,
	   #comTel#,
	   #unitProperties#,
	   #zipCode#,
	   #comEmail#,
	   #repairQualification#,
	   #hotLtel#,
	   #legalPerson#,
	   #comFax#,
	   #machineSerial#,
	   #registTime#,
	   #registIp#,
	   #comAccount#,
	   #authCode#,
	   #authorizationCode#,
	   #validDate#,
	   #approver#,
	   #approvalAdvice#,
	   #remark#,
	   #createBy#,
	   #createTime#,
	   #comContact#,
	   #registerAuthentication#,
	   #status#,
	   #comPassWord#,
	   #accessCode#,
	   #serviceStationSap#,
	   #approvalTime#,
	   #macAddress#,
	   #serviceVersion#
	   )
  </insert> 
  <!-- 审批 -->
  <update id="updateAuthApproval" parameterClass="map">
	  UPDATE <include refid="table" />
	   SET 
	   APPROVER = #approver#,
	   APPROVAL_ADVICE = #approvalAdvice#,
	   APPROVAL_TIME = #approvalTime#,
	   REMARK = #remark#,
	   STATUS = #status#,
	   REGISTER_AUTHENTICATION = #registerAuthentication#
	  WHERE COM_ID = #comId#
  </update>
    <!-- 管理-->
  <update id="updateAuthManage" parameterClass="map">
	  UPDATE <include refid="table" />
	   SET 
	   UPDATE_TIME =#updateTime#,
	   update_by =#updateBy#,
	   approval_time =#approvalTime#,
	   APPROVER = #approver#,
	   APPROVAL_ADVICE = #approvalAdvice#,
	   REMARK = #remark#,
	   register_authentication = #registerAuthentication#,
	   VALID_DATE = #validDate#
	  WHERE COM_ID = #comId#
  </update>
  <select id="selectPageForOnline" parameterClass="dynamicSqlParameter" resultMap="CompanyInfo">
		SELECT 
		  BB.* 
		FROM
		  (SELECT 
		    tb.COM_ID,
		    tb.CS_COM_ID,
		    tb.COM_NAME,
		    tb.COM_SHORT_NAME,
		    tb.COM_ADDRESS,
		    tb.PROVINCE,
		    tb.CITY,
		    tb.COUNTY,
		    tb.ZIP_CODE,
		    tb.COM_CONTACT,
		    tb.COM_EMAIL,
		    tb.COM_TEL,
		    tb.HOT_LTEL,
		    tb.COM_FAX,
		    tb.REPAIR_QUALIFICATION,
		    tb.UNIT_PROPERTIES,
		    tb.LEGAL_PERSON,
		    tb.CERTIFICATE_CODE,
		    tb.REGISTER_AUTHENTICATION,
		    tb.REGISTER_METHOD,
		    tb.COM_TYPE,
		    tb.MACHINE_SERIAL,
		    tb.MAC_ADDRESS,
		    tb.SERVICE_VERSION,
		    tb.SERVICE_STATUS,
		    tb.REGIST_TIME,
		    tb.REGIST_IP,
		    tb.CLIENT_NUMS,
		    tb.YT_CRM_LINKED_STATUS,
		    tb.SETBOOK_ID,
		    tb.STATUS,
		    tb.AUTHORIZATION_CODE,
		    tb.VALID_DATE,
		    tb.APPROVER,
		    tb.APPROVAL_TIME,
		    tb.APPROVAL_ADVICE,
		    tb.REMARK,
		    tb.ENABLE_FLAG,
		    tb.OPEN_BANK,
		    tb.BANK_ACCOUNT,
		    tb.VALUEADD_APP_ID,
		    tb.CREATE_BY,
		    tb.CREATE_TIME,
		    tb.UPDATE_BY,
		    tb.UPDATE_TIME,
		    tb.COM_ACCOUNT,
		    tb.COM_PASS_WORD,
		    tb.AUTH_CODE,
		   	tb.access_code,
	   		tb.service_station_sap,
		    IFNULL(a.total,'-') AS total
		  FROM
		    tb_ssp_com_info tb 
		    LEFT JOIN 
		      (SELECT 
		        COUNT(tb_user_online_id) AS total,
		        com_code 
		      FROM
		        tb_ssp_user_online 
		      WHERE online_status = '1'
		      GROUP BY com_code) a 
		      ON tb.com_id = a.com_code
		      <include refid="where_param" />
		     ) BB 
		ORDER BY create_time DESC 
	    LIMIT #startNum#,#pagesize#
  </select>
    <!-- 根据机器码更新鉴权状态-->
  <update id="updateByMachineCode" parameterClass="map" >
	  UPDATE <include refid="table" />
	   SET REGISTER_AUTHENTICATION = "1"
	  WHERE MACHINE_SERIAL = #machineSerial#
  </update>
  <!-- 根据机器码查询数量 -->
  <select id="countForRemote" parameterClass="map" resultClass="int">
	  select count(1) from <include refid="table" />
	  WHERE MACHINE_SERIAL = #machineSerial#
  </select>
  <!-- 根据comId查询数量 -->
  <select id="countForRemoteByComId" parameterClass="map" resultClass="int">
	  select count(1) from <include refid="table" />
	  WHERE COM_ID = #comId#
  </select>  
  <update id="updateForRemote" parameterClass="com.ctfo.operation.beans.CompanyInfo">
	  UPDATE  <include refid="table" />
	  SET 
	   COM_NAME =  #comName#,
	   PROVINCE = #province#,
	   CITY = #city#,
	   COUNTY = #county#,
	   COM_ADDRESS = #comAddress#,
	   COM_TEL = #comTel#,
	   UNIT_PROPERTIES = #unitProperties#,
	   ZIP_CODE = #zipCode#,
	   COM_EMAIL = #comEmail#,
	   REPAIR_QUALIFICATION = #repairQualification#,
	   HOT_LTEL = #hotLtel#,
	   LEGAL_PERSON = #legalPerson#,
	   COM_FAX = #comFax#,
	   MACHINE_SERIAL = #machineSerial#,
	   REGIST_TIME = #registTime#,
	   REGIST_IP = #registIp#,
	   COM_ACCOUNT = #comAccount#,
	   AUTH_CODE = #authCode#,
	   AUTHORIZATION_CODE = #authorizationCode#,
	   VALID_DATE = #validDate#,
	   APPROVER = #approver#,
	   APPROVAL_ADVICE = #approvalAdvice#,
	   REMARK = #remark#,
	   CREATE_BY = #createBy#,
	   CREATE_TIME = #createTime#,
	   COM_CONTACT = #comContact#,
	   REGISTER_AUTHENTICATION = #registerAuthentication#,
	   STATUS = #status#,
	   COM_PASS_WORD = #comPassWord#,
	   UPDATE_TIME = #updateTime#,
	   access_code = #accessCode#,
	   service_station_sap = #serviceStationSap#
	WHERE MACHINE_SERIAL = #machineSerial#
  </update>
  <!-- 查询所有服务站信息 -->
  <select id="selectComanyInfo" resultClass="com.ctfo.operation.beans.CompanyInfo">
		SELECT com_account 		AS comAccount,
			   com_pass_word 	AS comPassWord,
			   auth_code 		AS authCode,
			   com_id		AS comId
		  FROM tb_ssp_com_info
			WHERE com_account IS NOT NULL AND com_account != ''
			  AND com_pass_word IS NOT NULL AND com_pass_word != ''
			  AND auth_code IS NOT NULL AND auth_code != ''
			  AND com_id IS NOT NULL AND com_id != ''
  </select>
   <select id="selectByMachineCode" parameterClass="string" resultMap="CompanyInfo">
	SELECT 
    <include refid="columns" /> 
     FROM 
    <include refid="table" />
	where MACHINE_SERIAL = #machineCode:VARCHAR#
  </select>
  <select id="selectPKByCom" parameterClass="string" resultMap="CompanyInfoByUser">
	SELECT 
	  fcom.com_id,
	  fcom.com_name,
	  fcom.com_contact,
	  fcom.province,
	  fcom.city,
	  fcom.county,
	  fcom.com_address,
	  fcom.com_tel,
	  fcom.zip_code,
	  fcom.repair_qualification,
	  fcom.legal_person,
	  fcom.unit_properties AS UNIT_PROPERTIES,
	  fcom.com_email,
	  fcom.service_phone AS HOT_LTEL,
	  fcom.com_fax,
	  si.apply_time AS regist_time,
	  si.server_ip AS regist_ip,
	  si.authentication_status AS register_authentication,
	  fcom.status,
	  si.s_user AS com_account,
	  si.authentication AS AUTH_CODE,
	  si.machine_code_sequence AS machine_serial,
	  si.grant_authorization AS authorization_code,
	  fcom.remark,
	  si.protocol_expires_time AS valid_date
	FROM
	  (SELECT 
	    IF(is_total_company = 1,com.com_id,com.parent_id) ent_id,com.*
	  FROM
	    tb_company com) fcom
	  LEFT JOIN tb_signing_info si 
	    ON fcom.ent_id = si.ser_station_id
    where fcom.COM_ID = #comId:VARCHAR#
  </select>
</sqlMap>